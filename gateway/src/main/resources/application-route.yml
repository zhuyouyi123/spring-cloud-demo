spring:
  cloud:
    gateway:
      globalcors:
        cors-configurations:
          '[/**]':
            allowed-origins: "*"
            allowedMethods: "*"
            allowedHeaders: "*"
      routes:
        - id: bing-route
          uri: https://cn.bing.com
          predicates:
            - name: Path
              args:
                  paths: /search
            - name: Query
              args:
                  param: q
                  regex: nihao
            # - Vip= user:nihao
            # http://localhost/search?q=haha&user=nihao
            - name: Vip
              args:
                  param: user
                  value: nihao
          order: 999
        # 全局唯一不重复
        - id: order-route
          # 目的地
          uri: lb://service-order
          # 断言 有两种方式 方式1
          predicates:
            - Path=/api/order/**,/order/**
          filters:
            - OnceToken=X-Response-Token,uuid
          # 元数据
          metadata:
            hello: world
          # 顺序
          order: 1
        - id: product-route
          uri: lb://service-product
          # 过滤器
#          filters:
#            - RewritePath=/api/product/?(?<segment>.*), /$\{segment}
#            - AddResponseHeader=X-Response-Default-Foo, Default-Bar
#            - AddRequestParameter=foo, bar
#            - AddRequestHeader=X-Request-Default-Foo, Default-Bar
          # 断言 方式2
          predicates:
            #- Path=/api/product/**,/product/**
            - name: Path
              args:
                  paths: /api/product/**,/product/**
                  # 匹配单段 好像是判断后面有没有斜杠的 可选
                  matchSingleSegment: true
            - name: Query
              args:
                param: id
                regex: \d+
      default-filters:
        - AddResponseHeader=X-Response-Default-Foo, Default-Bar
